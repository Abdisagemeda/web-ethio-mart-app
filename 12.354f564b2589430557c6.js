(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{Ao8N:function(t,o,i){"use strict";i.r(o),i.d(o,"ProductsModule",function(){return mt});var e=i("Xa2L"),n=i("/1cH"),c=i("iadO"),a=i("1jcm"),l=i("d3UM"),s=i("NFeN"),r=i("qFsG"),d=i("0IaG"),u=i("V5BG"),f=i("Q4Mo"),b=i("jIHw"),p=i("7kUa"),h=i("3Pt+"),m=i("rEr+"),g=i("PCNd"),v=i("ofXK"),C=i("mrSG"),y=i("fXoL"),k=i("WLRH");function w(t,o){if(1&t){const t=y.Xb();y.Wb(0,"button",9),y.ec("click",function(){return y.Ec(t),y.hc().onSave()}),y.Rb(1,"span",10),y.Wb(2,"span",6),y.Qc(3),y.Vb(),y.Rb(4,"span",7),y.Vb()}if(2&t){const t=y.hc();y.oc("disabled",0===t.data.length),y.Cb(3),y.Rc(t.button)}}let V=(()=>{class t{constructor(t){this.config=t,this.formSubmit=new y.o,this.modalAction=new y.o,this.formSave=new y.o,this.formClose=new y.o,this.columns=[],this.data=[],this.actions=[],this.toolBarActions=[],this.save=!0}ngOnInit(){var t,o,i,e,n,c,a,l,s,r,d,u,f,b;this.caption=null===(o=null===(t=this.config)||void 0===t?void 0:t.lookupData)||void 0===o?void 0:o.caption,this.button=null===(e=null===(i=this.config)||void 0===i?void 0:i.lookupData)||void 0===e?void 0:e.button,this.id=null===(c=null===(n=this.config)||void 0===n?void 0:n.lookupData)||void 0===c?void 0:c.id,this.columns=(null===(l=null===(a=this.config)||void 0===a?void 0:a.lookupData)||void 0===l?void 0:l.columns)||[],this.data=(null===(r=null===(s=this.config)||void 0===s?void 0:s.lookupData)||void 0===r?void 0:r.data)||[],this.actions=(null===(u=null===(d=this.config)||void 0===d?void 0:d.lookupData)||void 0===u?void 0:u.actions)||[],this.toolBarActions=(null===(b=null===(f=this.config)||void 0===f?void 0:f.lookupData)||void 0===b?void 0:b.toolBarActions)||[]}onActionClick(t){this.modalAction.emit(t),"trash"===t.type&&(this.data=this.data.filter(o=>o.id!==t.data.id))}onToolBarActionClick(t){}onCancel(){this.formClose.emit()}onSave(){"save"===this.button.toLowerCase()?this.formSave.emit(this.data):this.id&&"detail"===this.button.toLowerCase()&&this.formSave.emit(this.id)}}return t.\u0275fac=function(o){return new(o||t)(y.Qb(d.a))},t.\u0275cmp=y.Kb({type:t,selectors:[["app-model-table"]],inputs:{data:"data"},outputs:{formSubmit:"formSubmit",modalAction:"modalAction",formSave:"formSave",formClose:"formClose"},decls:11,vars:8,consts:[[1,"p-dialog-content",2,"overflow","hidden","overflow-x","auto"],[1,"capitalize",2,"font-size","large"],[3,"columns","data","isInModal","hasOrder","actions","toolBarActions","buttonClick","toolBarButtonClick"],["mat-dialog-actions","",1,"p-dialog-footer","button-row"],["pbutton","","pripple","","icon","pi pi-times",1,"p-button-text","p-ripple","p-button","p-component","shadow-none","p-mr-2",2,"margin-bottom","0!important",3,"click"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-times"],[1,"p-button-label"],[1,"p-ink"],["pbutton","","pripple","","icon","pi pi-check","class","p-button-text p-ripple p-button p-component shadow-none",3,"disabled","click",4,"ngIf"],["pbutton","","pripple","","icon","pi pi-check",1,"p-button-text","p-ripple","p-button","p-component","shadow-none",3,"disabled","click"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-check"]],template:function(t,o){1&t&&(y.Wb(0,"div",0),y.Wb(1,"div",1),y.Qc(2),y.Vb(),y.Wb(3,"app-table-template",2),y.ec("buttonClick",function(t){return o.onActionClick(t)})("toolBarButtonClick",function(t){return o.onToolBarActionClick(t)}),y.Vb(),y.Vb(),y.Wb(4,"div",3),y.Wb(5,"button",4),y.ec("click",function(){return o.onCancel()}),y.Rb(6,"span",5),y.Wb(7,"span",6),y.Qc(8,"Cancel"),y.Vb(),y.Rb(9,"span",7),y.Vb(),y.Oc(10,w,5,2,"button",8),y.Vb()),2&t&&(y.Cb(2),y.Sc("=> ",o.caption,""),y.Cb(1),y.oc("columns",o.columns)("data",o.data)("isInModal",!0)("hasOrder",!1)("actions",o.actions)("toolBarActions",o.toolBarActions),y.Cb(7),y.oc("ngIf",void 0!==o.button))},directives:[k.a,d.c,v.m],styles:[""]}),t})();var W=i("4ZtF"),O=i("nnAt"),D=i("/zas"),I=i("UbJi"),S=i("otk6"),Q=i("kmnG"),x=i("FKr1"),N=i("xivw");function M(t,o){if(1&t&&(y.Wb(0,"mat-option",23),y.Qc(1),y.Vb()),2&t){const t=o.$implicit;y.oc("value",t.name),y.Cb(1),y.Sc(" ",t.name," ")}}function A(t,o){1&t&&(y.Wb(0,"mat-hint"),y.Qc(1,"changing choices you will lose your data! "),y.Vb())}function B(t,o){if(1&t&&(y.Wb(0,"mat-error",24),y.Qc(1),y.Vb()),2&t){const t=y.hc();y.Cb(1),y.Rc(t.displayMessage.name)}}function j(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function P(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,j,2,0,"span",11),y.Vb(),y.Wb(4,"input",28),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"email")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"email")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function E(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function _(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,E,2,0,"span",11),y.Vb(),y.Wb(4,"input",29),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"int")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"int")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function F(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function q(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,F,2,0,"span",11),y.Vb(),y.Wb(4,"input",29),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"price")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"price")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function G(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function R(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,G,2,0,"span",11),y.Vb(),y.Wb(4,"input",28),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"date")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"date")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function T(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function X(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,T,2,0,"span",11),y.Vb(),y.Wb(4,"input",28),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"phone")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"phone")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function z(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function U(t,o){if(1&t){const t=y.Xb();y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,z,2,0,"span",11),y.Vb(),y.Wb(4,"input",28),y.ec("input",function(o){return y.Ec(t),y.hc(2).keyDown(o,"text")})("keydown",function(o){return y.Ec(t),y.hc(2).keyDown(o,"text")}),y.Vb(),y.Vb()}if(2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name)}}function $(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function K(t,o){if(1&t){const t=y.Xb();y.Wb(0,"textarea",31),y.ec("input",function(o){return y.Ec(t),y.hc(3).keyDown(o,"text")})("keydown",function(o){return y.Ec(t),y.hc(3).keyDown(o,"text")}),y.Vb()}if(2&t){const t=y.hc(2).index,o=y.hc();y.oc("formControlName",o.fieldControls[t].name)}}function H(t,o){if(1&t&&(y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,$,2,0,"span",11),y.Vb(),y.Oc(4,K,1,1,"textarea",30),y.Vb()),2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("ngIf",""===o.fieldControls[t].type)}}function L(t,o){1&t&&(y.Wb(0,"span",24),y.Qc(1,"*"),y.Vb())}function J(t,o){if(1&t&&(y.Wb(0,"mat-option",23),y.Wb(1,"span"),y.Qc(2),y.Vb(),y.Vb()),2&t){const t=o.$implicit;y.oc("value",t.name),y.Cb(2),y.Rc(t.name)}}function Z(t,o){if(1&t&&(y.Wb(0,"mat-form-field",7),y.Wb(1,"mat-label",27),y.Qc(2),y.Oc(3,L,2,0,"span",11),y.Vb(),y.Wb(4,"mat-select",32),y.Oc(5,J,3,2,"mat-option",9),y.Vb(),y.Vb()),2&t){const t=y.hc().index,o=y.hc();y.Cb(2),y.Sc(" ",o.fieldControls[t].label," "),y.Cb(1),y.oc("ngIf",o.fieldControls[t].required),y.Cb(1),y.oc("formControlName",o.fieldControls[t].name),y.Cb(1),y.oc("ngForOf",null==o.fieldControls[t]?null:o.fieldControls[t].options)}}function Y(t,o){if(1&t){const t=y.Xb();y.Wb(0,"div",7),y.Wb(1,"app-file-upload-template",33),y.ec("fileDropped",function(o){return y.Ec(t),y.hc(2).getFile(o)}),y.Vb(),y.Vb()}if(2&t){const t=y.hc(2);y.Cb(1),y.oc("uploadedFile",t.image)}}function tt(t,o){if(1&t&&(y.Wb(0,"div",25),y.Oc(1,P,5,3,"mat-form-field",26),y.Oc(2,_,5,3,"mat-form-field",26),y.Oc(3,q,5,3,"mat-form-field",26),y.Oc(4,R,5,3,"mat-form-field",26),y.Oc(5,X,5,3,"mat-form-field",26),y.Oc(6,U,5,3,"mat-form-field",26),y.Oc(7,H,5,3,"mat-form-field",26),y.Oc(8,Z,6,4,"mat-form-field",26),y.Oc(9,Y,2,1,"div",26),y.Vb()),2&t){const t=o.index,i=y.hc();y.oc("formGroupName",0),y.Cb(1),y.oc("ngIf","email"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","number"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","price"===i.fieldControls[t].type||"float"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","date"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","phone"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","text"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","textarea"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","dropdown"===i.fieldControls[t].type),y.Cb(1),y.oc("ngIf","file"===i.fieldControls[t].type)}}const ot=function(){return{standalone:!0}};let it=(()=>{class t{constructor(t,o,i,e,n){var c,a,l,s,r,d,u,f,b,p,m,g,v;this.fb=t,this.sessionQuery=o,this.auth=i,this.fun=e,this.config=n,this.formSubmit=new y.o,this.formClose=new y.o,this.isPublished=!1,this.fieldControls=[],this.selectedCategory=[],this.file=[],this.displayMessage={},this.category=null===(c=this.config.lookupData)||void 0===c?void 0:c.category,this.image=Object(W.k)(null===(a=this.config.formData)||void 0===a?void 0:a.image)?null===(l=this.config.formData)||void 0===l?void 0:l.image:Object(W.p)(null===(s=this.config.formData)||void 0===s?void 0:s.image)?[null===(r=this.config.formData)||void 0===r?void 0:r.image]:[],this.isPublished=(null===(d=this.config.formData)||void 0===d?void 0:d.status)||!0,this.id=null===(u=this.config.formData)||void 0===u?void 0:u.id,this.category.subscribe(t=>{var o;this.selectedCategory=t,null!==this.id&&this.change(null===(o=this.config.formData)||void 0===o?void 0:o.category)}),this.form=this.fb.group({id:this.id,additional_fields:this.fb.group({fields:this.fb.array([new h.g({})])}),category:[null===(f=this.config.formData)||void 0===f?void 0:f.category,h.v.required],status:[this.isPublished,h.v.required],user:(null===(b=this.config.formData)||void 0===b?void 0:b.user)||(null===(m=null===(p=this.sessionQuery)||void 0===p?void 0:p.user)||void 0===m?void 0:m.name),uid:(null===(g=this.config.formData)||void 0===g?void 0:g.uid)||null,created_at:null===(v=this.config.formData)||void 0===v?void 0:v.created_at}),this.validationMessages={category:{required:"field is required."}},this.genericValidator=new O.a(this.validationMessages)}get fields(){return this.form.controls.additional_fields.get("fields")}ngOnInit(){this.auth.user.subscribe(t=>{this.uid=null==t?void 0:t.uid}),this.form.valueChanges.subscribe(()=>this.displayMessage=this.genericValidator.processMessages(this.form))}blur(){this.displayMessage=this.genericValidator.processMessages(this.form)}keyDown(t,o){return t.key?this.fun.allowedKey(t.key,o):(t.target.value=this.fun.removeNotAllowedKey(t.target.value,o),!0)}change(t){var o,i;const e=null===(o=this.selectedCategory.filter(o=>o.name===t)[0])||void 0===o?void 0:o.fields;this.detail=null===(i=this.selectedCategory.filter(o=>o.name===t)[0])||void 0===i?void 0:i.Details,this.fields.removeAt(0),this.fieldControls=[];const n=new h.g({});e&&e.forEach(t=>{var o;const i=[];"email"===t.type&&i.push(h.v.email),t.required&&i.push(h.v.required);const e=i.length>0?[...i]:null;this.fieldControls.push(t),n.addControl(t.name,this.fb.control((null===(o=this.config)||void 0===o?void 0:o.formData[t.name])||t.default,e))}),this.fields.push(n)}getFile(t){this.file=(null==t?void 0:t.upload.length)>0?null==t?void 0:t.upload:[]}onSubmit(){const t=this.fieldControls.filter(t=>"file"===t.type);t.length>0&&this.file.length>0&&(this.form.value.additional_fields.fields[0][t[0].name]=this.file);const o=Object(C.__rest)(this.form.value,[]),i=Object.assign({},o.additional_fields.fields[0]),e=Object(C.__rest)(i,[]);delete o.additional_fields;const n=Object.assign(Object.assign(Object.assign({},e),o),{uid:null===o.uid?this.uid:o.uid,Details:this.detail||null,status:this.isPublished});this.formSubmit.emit(n)}onCancel(){this.formClose.emit()}}return t.\u0275fac=function(o){return new(o||t)(y.Qb(h.e),y.Qb(D.a),y.Qb(I.a),y.Qb(S.a),y.Qb(d.a))},t.\u0275cmp=y.Kb({type:t,selectors:[["app-product-form"]],outputs:{formSubmit:"formSubmit",formClose:"formClose"},decls:36,vars:12,consts:[["autocomplete","off",3,"formGroup","submit"],["mat-dialog-title","",1,"p-dialog-header","p-d-flex","p-jc-lg-between",2,"padding","0.2re 0.3rem"],[1,"p-dialog-title","capitalize"],["pButton","","pRipple","","icon","pi pi-times",1,"shadow-none","p-button-rounded","p-button-plain","p-button-text","p-mr-1",3,"click"],["mat-dialog-content","",1,"p-dialog-content"],[1,"p-grid"],[1,"p-col-12"],[1,"full-width"],["formControlName","category",3,"closed","valueChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","error",4,"ngIf"],["formGroupName","additional_fields",1,"p-col-12"],["formArrayName","fields"],[3,"formGroupName",4,"ngFor","ngForOf"],["color","primary","forControlName","status",1,"example-section",3,"ngModel","ngModelOptions","ngModelChange"],["mat-dialog-actions","",1,"p-dialog-footer","button-row"],["pbutton","","pripple","","label","Cancel","type","button","icon","pi pi-times",1,"p-button-text","p-ripple","p-button","p-component","shadow-none","p-mr-2",3,"click"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-times"],[1,"p-button-label"],[1,"p-ink"],["pbutton","","pripple","","label","Save","icon","pi pi-check","type","submit",1,"p-button-text","p-ripple","p-button","p-component","shadow-none",3,"disabled"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-check"],[3,"value"],[1,"error"],[3,"formGroupName"],["class","full-width",4,"ngIf"],[1,"capitalize"],["matInput","","type","text","value","",3,"formControlName","input","keydown"],["matInput","","type","number","value","",3,"formControlName","input","keydown"],["matInput","","rows","2","type","text","value","",3,"formControlName","input","keydown",4,"ngIf"],["matInput","","rows","2","type","text","value","",3,"formControlName","input","keydown"],[3,"formControlName"],[3,"uploadedFile","fileDropped"]],template:function(t,o){1&t&&(y.Wb(0,"form",0),y.ec("submit",function(){return o.onSubmit()}),y.Wb(1,"div",1),y.Wb(2,"div",2),y.Qc(3),y.Vb(),y.Wb(4,"button",3),y.ec("click",function(){return o.onCancel()}),y.Vb(),y.Vb(),y.Wb(5,"div",4),y.Wb(6,"div",5),y.Wb(7,"div",6),y.Wb(8,"mat-form-field",7),y.Wb(9,"mat-label"),y.Qc(10,"Category"),y.Vb(),y.Wb(11,"mat-select",8),y.ec("closed",function(){return o.blur()})("valueChange",function(t){return o.change(t)}),y.Oc(12,M,2,2,"mat-option",9),y.ic(13,"async"),y.Vb(),y.Oc(14,A,2,0,"mat-hint",10),y.Oc(15,B,2,1,"mat-error",11),y.Vb(),y.Vb(),y.Wb(16,"div",12),y.Wb(17,"div",13),y.Oc(18,tt,10,10,"div",14),y.Vb(),y.Vb(),y.Wb(19,"mat-slide-toggle",15),y.ec("ngModelChange",function(t){return o.isPublished=t}),y.Wb(20,"span"),y.Qc(21,"Status"),y.Vb(),y.Rb(22,"br"),y.Wb(23,"mat-hint"),y.Qc(24,"block or allow product from displaying"),y.Vb(),y.Vb(),y.Vb(),y.Vb(),y.Wb(25,"div",16),y.Wb(26,"button",17),y.ec("click",function(){return o.onCancel()}),y.Rb(27,"span",18),y.Wb(28,"span",19),y.Qc(29,"Cancel"),y.Vb(),y.Rb(30,"span",20),y.Vb(),y.Wb(31,"button",21),y.Rb(32,"span",22),y.Wb(33,"span",19),y.Qc(34,"Save"),y.Vb(),y.Rb(35,"span",20),y.Vb(),y.Vb(),y.Vb()),2&t&&(y.oc("formGroup",o.form),y.Cb(3),y.Rc(o.config.title),y.Cb(9),y.oc("ngForOf",y.jc(13,9,o.category)),y.Cb(2),y.oc("ngIf",null===o.id),y.Cb(1),y.oc("ngIf",o.displayMessage.name),y.Cb(3),y.oc("ngForOf",o.fieldControls),y.Cb(1),y.oc("ngModel",o.isPublished)("ngModelOptions",y.rc(11,ot)),y.Cb(12),y.oc("disabled",!o.form.valid))},directives:[h.w,h.q,h.h,d.g,b.b,f.a,d.e,Q.c,Q.g,l.a,h.p,h.f,v.l,v.m,h.i,h.d,a.a,h.s,Q.f,d.c,x.h,Q.b,r.b,h.c,h.t,N.a],pipes:[v.b],styles:[".example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}"]}),t})();var et=i("12jx"),nt=i("lJxs"),ct=i("sSZD"),at=i("wD+u");let lt=(()=>{let t=class extends W.b{constructor(){super()}};return t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=y.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t=Object(C.__decorate)([Object(W.i)({name:"products",resettable:!0})],t),t})(),st=(()=>{class t{constructor(t,o,i,e){this.db=t,this.firestore=o,this.store=i,this.fun=e,this.url="/Product"}get(t=null){const o=`${this.url}`;return t?this.firestore.collection(o).doc(t).collection(t+"s"):this.firestore.collection(o).auditTrail().pipe(Object(nt.a)(t=>{const o=[];t.map(t=>{var i,e;const n=null===(e=null===(i=t.payload)||void 0===i?void 0:i.doc)||void 0===e?void 0:e.id,c=t.payload.doc.data().details;this.fitch(n).subscribe(t=>{const i=t.map(t=>{var o,i,e,c;return Object.assign({id:null===(i=null===(o=t.payload)||void 0===o?void 0:o.doc)||void 0===i?void 0:i.id,category:n,showMore:!1},null===(c=null===(e=t.payload)||void 0===e?void 0:e.doc)||void 0===c?void 0:c.data())});o.push({id:n,category:n,details:c||"",items:i.length,data:i});const e=[...new Map(o.map(t=>[t.id,t])).values()];this.store.set(e)})})}))}add(t,o=null){var i;delete t.id;const e=[],n=`${this.url}`;return(null===(i=null==t?void 0:t.image)||void 0===i?void 0:i.length)>0?t.image.forEach((i,c)=>this.fun.storeToFirebase(i,this.url).then(i=>{if(e.push(i),c+1===t.image.length)return t.image=e,t.created_at=(new Date).toISOString(),this.firestore.collection(n).doc(t.category).collection(t.category+"s").add(t).then(t=>{this.get(),this.fun.notify("Added"),o.ref.close(),o.block.stop()}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)});c++}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)})):(t.created_at=(new Date).toISOString(),this.firestore.collection(n).doc(t.category).collection(t.category+"s").add(t).then(t=>{this.get(),this.fun.notify("Added"),o.ref.close(),o.block.stop()}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)}))}update(t,o,i=null){var e;delete o.id;let n=0;const c=[];return(null===(e=null==o?void 0:o.image)||void 0===e?void 0:e.length)>0?o.image.forEach((e,a)=>null==(null==e?void 0:e.url)?this.fun.storeToFirebase(e,this.url).then(e=>{if(c.push(e),n++,a+1===o.image.length)return o.image=c,this.firestore.collection(this.url).doc(o.category).collection(o.category+"s").doc(t).update(o).then(t=>{this.get(),this.fun.notify("Updated"),i.ref.close(),i.block.stop()}).catch(t=>{i.block.stop(),this.fun.notify("","Something error occur",3e3)});a++}).catch(t=>{i.block.stop(),this.fun.notify("","Something error occur",3e3)}):(c.push(null==e?void 0:e.url),0===n?(o.image=c,this.firestore.collection(this.url).doc(o.category).collection(o.category+"s").doc(t).update(o).then(t=>{this.get(),this.fun.notify("Update"),i.ref.close(),i.block.stop()}).catch(t=>{i.block.stop(),this.fun.notify("","Something error occur",3e3)})):void 0)):this.firestore.collection(this.url).doc(o.category).collection(o.category+"s").doc(t).update(o).then(t=>{this.get(),this.fun.notify("Update"),i.ref.close(),i.block.stop()}).catch(t=>{i.block.stop(),this.fun.notify("","Something error occur",3e3)})}delete(t,o=null){return this.firestore.collection(this.url).doc(o).collection(o+"s").doc(t).delete().finally(()=>{this.get()})}fitch(t){return this.firestore.collection(this.url).doc(t).collection(t+"s").snapshotChanges()}}return t.\u0275fac=function(o){return new(o||t)(y.ac(ct.a),y.ac(at.a),y.ac(lt),y.ac(S.a))},t.\u0275prov=y.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),rt=(()=>{let t=class extends W.f{constructor(t){super(t),this.store=t}};return t.\u0275fac=function(o){return new(o||t)(y.ac(lt))},t.\u0275prov=y.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t=Object(C.__decorate)([Object(W.e)({sortBy:"id",sortByOrder:W.c.DESC})],t),t})();var dt=i("GaOe"),ut=i("H0VJ");let ft=(()=>{class t{constructor(t,o,i,e,n){this.productService=t,this.productsQuery=o,this.fun=i,this.categoryService=e,this.dialogServices=n,this.caption="Products",this.columns=[{label:"Category",name:"category",sortable:!0},{label:"Detail",name:"details",sortable:!1},{label:"Items",name:"items",type:"link",sortable:!0}],this.actions=[],this.toolBarActions=[{position:"right",action:[]},{position:"left",action:[{label:"Create",icon:"plus",color:"",tooltip:null}]}],this.product$=this.productsQuery.selectAll(),this.loading$=this.productsQuery.selectLoading(),this.dialogConfig={width:"540px",formComponent:it,service:this.productService},this.dialogConfigModal={closable:!0,formComponent:V}}ngOnInit(){var t;this.stateHistory=new W.g(this.productsQuery),null===(t=this.productService.get())||void 0===t||t.subscribe(),this.category=this.categoryService.get().valueChanges()}add(t=null){this.dialogConfig.title="New product",this.dialogConfig.formData=null!==t?t:"",this.dialogConfig.lookupData={category:this.category},this.dialogServices.handleDialog(this.dialogConfig)}update(t){this.dialogConfig.title="Edit product",this.dialogConfig.formData=t,this.dialogConfig.lookupData={category:this.category},this.dialogServices.handleDialog(this.dialogConfig)}onActionClick(t){"pencil"===t.type?this.update(t.data):"trash"===t.type?this.productService.delete(t.data.id,t.data.category).then(this.blockUI.stop()):"link"===t.type&&this.showModalTable(t.data)}showModalTable(t){const o=t.category,i="Vehicle"===o?["Name","Model","Color","Price","images","Condition","Transemission","Contact"]:"Home"===o?["Name","Property address","Number of bedrooms","Number of bathrooms","Price","images","furnishing","property size"]:"Furniture"===o?["Name","Price","Item Quantity","images","Item Description","Contact","Size"]:"Fashion"===o?["Name","Price","Item Quantity","images","Item Description","Item Type","Contact","Size"]:"Gift"===o?["Name","Price","Item Quantity","images","Item Description"]:"Sport"===o?["Name","Price","images","Size","Item Description","Item Quantity"]:null;this.blockUI.stop(),this.dialogConfigModal.width="1400px",this.dialogConfigModal.lookupData={caption:t.category,columns:this.fun.getColumns(null!==i?i:Object.keys(t.data[0])),data:t.data,actions:[{icon:"pencil",color:"warning",disable:!1},{icon:"trash",color:"danger"}],toolBarActions:[]};const e=this.dialogServices.handleDialog(this.dialogConfigModal);this.handleModalChange(e)}handleModalChange(t){var o,i;null===(i=null===(o=t.componentInstance)||void 0===o?void 0:o.modalAction)||void 0===i||i.subscribe(o=>{this.onActionClick(o),this.product$.subscribe(i=>{var e;const n=null===(e=null==o?void 0:o.data)||void 0===e?void 0:e.category,c=i.filter(t=>t.id===n);t.componentInstance.data=c[0].data})})}onToolBarActionClick(t){"plus"===t?this.add():""!==t.split(",")[1]&&this.add({category:t.split(",")[0]})}}return t.\u0275fac=function(o){return new(o||t)(y.Qb(st),y.Qb(rt),y.Qb(S.a),y.Qb(dt.a),y.Qb(ut.a))},t.\u0275cmp=y.Kb({type:t,selectors:[["app-product"]],decls:2,vars:11,consts:[[3,"caption","columns","data","actions","first","rows","sortBy","hasGrouped","toolBarActions","buttonClick","toolBarButtonClick"]],template:function(t,o){1&t&&(y.Wb(0,"app-table-template",0),y.ec("buttonClick",function(t){return o.onActionClick(t)})("toolBarButtonClick",function(t){return o.onToolBarActionClick(t)}),y.ic(1,"async"),y.Vb()),2&t&&y.oc("caption",o.caption)("columns",o.columns)("data",y.jc(1,9,o.product$))("actions",o.actions)("first",(null==o.currentPage?null:o.currentPage.first)||0)("rows",(null==o.currentPage?null:o.currentPage.rows)||10)("sortBy",o.sortBy)("hasGrouped",!0)("toolBarActions",o.toolBarActions)},directives:[k.a],pipes:[v.b],styles:[""]}),Object(C.__decorate)([Object(et.a)()],t.prototype,"blockUI",void 0),t})();var bt=i("tyNb");const pt=[{path:"",component:ft},{path:"**",redirectTo:""}];let ht=(()=>{class t{}return t.\u0275mod=y.Ob({type:t}),t.\u0275inj=y.Nb({factory:function(o){return new(o||t)},imports:[[bt.e.forChild(pt)],bt.e]}),t})(),mt=(()=>{class t{}return t.\u0275mod=y.Ob({type:t}),t.\u0275inj=y.Nb({factory:function(o){return new(o||t)},imports:[[v.c,ht,g.a,m.f,h.j,h.u,p.b,b.c,f.b,u.a,d.f,Q.e,r.c,s.a,l.b,a.b,c.a,n.a,e.a]]}),t})()}}]);