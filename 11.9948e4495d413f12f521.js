(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{Ao8N:function(t,o,e){"use strict";e.r(o),e.d(o,"ProductsModule",function(){return nt});var i=e("Xa2L"),n=e("/1cH"),c=e("iadO"),r=e("1jcm"),l=e("d3UM"),a=e("NFeN"),s=e("qFsG"),u=e("0IaG"),d=e("V5BG"),f=e("Q4Mo"),p=e("jIHw"),h=e("7kUa"),b=e("3Pt+"),m=e("rEr+"),g=e("PCNd"),y=e("ofXK"),C=e("mrSG"),v=e("4ZtF"),k=e("nnAt"),w=e("fXoL"),V=e("/zas"),O=e("UbJi"),W=e("otk6"),D=e("kmnG"),I=e("FKr1"),S=e("xivw");function x(t,o){if(1&t&&(w.Wb(0,"mat-option",23),w.Qc(1),w.Vb()),2&t){const t=o.$implicit;w.oc("value",t.name),w.Cb(1),w.Sc(" ",t.name," ")}}function N(t,o){1&t&&(w.Wb(0,"mat-hint"),w.Qc(1,"changing choices you will lose your data! "),w.Vb())}function Q(t,o){if(1&t&&(w.Wb(0,"mat-error",24),w.Qc(1),w.Vb()),2&t){const t=w.hc();w.Cb(1),w.Rc(t.displayMessage.name)}}function j(t,o){1&t&&(w.Wb(0,"span",24),w.Qc(1,"*"),w.Vb())}function E(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"email")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"email")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function M(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"int")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"int")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function F(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"price")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"price")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function _(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"date")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"date")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function B(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"phone")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"phone")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function P(t,o){if(1&t){const t=w.Xb();w.Wb(0,"input",31),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"text")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"text")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function A(t,o){if(1&t){const t=w.Xb();w.Wb(0,"textarea",32),w.ec("input",function(o){return w.Ec(t),w.hc(3).keyDown(o,"text")})("keydown",function(o){return w.Ec(t),w.hc(3).keyDown(o,"text")}),w.Vb()}if(2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name)}}function G(t,o){if(1&t&&(w.Wb(0,"mat-option",23),w.Wb(1,"span"),w.Qc(2),w.Vb(),w.Vb()),2&t){const t=o.$implicit;w.oc("value",t.name),w.Cb(2),w.Rc(t.name)}}function X(t,o){if(1&t&&(w.Wb(0,"mat-select",33),w.Oc(1,G,3,2,"mat-option",9),w.Vb()),2&t){const t=w.hc(2).index,o=w.hc();w.oc("formControlName",o.fieldControls[t].name),w.Cb(1),w.oc("ngForOf",null==o.fieldControls[t]?null:o.fieldControls[t].options)}}function R(t,o){if(1&t&&(w.Wb(0,"mat-form-field",7),w.Wb(1,"mat-label",27),w.Qc(2),w.Oc(3,j,2,0,"span",11),w.Vb(),w.Oc(4,E,1,1,"input",28),w.Oc(5,M,1,1,"input",28),w.Oc(6,F,1,1,"input",28),w.Oc(7,_,1,1,"input",28),w.Oc(8,B,1,1,"input",28),w.Oc(9,P,1,1,"input",28),w.Oc(10,A,1,1,"textarea",29),w.Oc(11,X,2,2,"mat-select",30),w.Vb()),2&t){const t=w.hc().index,o=w.hc();w.Cb(2),w.Sc(" ",o.fieldControls[t].label," "),w.Cb(1),w.oc("ngIf",o.fieldControls[t].required),w.Cb(1),w.oc("ngIf","email"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","number"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","price"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","date"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","phone"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","text"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","textarea"===o.fieldControls[t].type),w.Cb(1),w.oc("ngIf","dropdown"===o.fieldControls[t].type)}}function q(t,o){if(1&t){const t=w.Xb();w.Wb(0,"div",7),w.Wb(1,"app-file-upload-template",34),w.ec("fileDropped",function(o){return w.Ec(t),w.hc(2).getFile(o)}),w.Vb(),w.Vb()}if(2&t){const t=w.hc(2);w.Cb(1),w.oc("uploadedFile",t.image)}}function U(t,o){if(1&t&&(w.Wb(0,"div",25),w.Oc(1,R,12,10,"mat-form-field",26),w.Oc(2,q,2,1,"div",26),w.Vb()),2&t){const t=o.index,e=w.hc();w.oc("formGroupName",0),w.Cb(1),w.oc("ngIf","file"!==e.fieldControls[t].type),w.Cb(1),w.oc("ngIf","file"===e.fieldControls[t].type)}}const $=function(){return{standalone:!0}};let K=(()=>{class t{constructor(t,o,e,i,n){var c,r,l,a,s,u,d,f,p,h,m;this.fb=t,this.sessionQuery=o,this.auth=e,this.fun=i,this.config=n,this.formSubmit=new w.o,this.formClose=new w.o,this.isPublished=!1,this.fieldControls=[],this.selectedCategory=[],this.file=[],this.displayMessage={},this.category=null===(c=this.config.lookupData)||void 0===c?void 0:c.category,this.image=Object(v.j)(null===(r=this.config.formData)||void 0===r?void 0:r.image)?null===(l=this.config.formData)||void 0===l?void 0:l.image:Object(v.n)(null===(a=this.config.formData)||void 0===a?void 0:a.image)?[null===(s=this.config.formData)||void 0===s?void 0:s.image]:[],this.isPublished=(null===(u=this.config.formData)||void 0===u?void 0:u.status)||!0,this.id=null===(d=this.config.formData)||void 0===d?void 0:d.id,this.category.subscribe(t=>{var o;this.selectedCategory=t,null!==this.id&&this.change(null===(o=this.config.formData)||void 0===o?void 0:o.category)}),this.form=this.fb.group({id:this.id,additional_fields:this.fb.group({fields:this.fb.array([new b.g({})])}),category:[null===(f=this.config.formData)||void 0===f?void 0:f.category,b.u.required],status:[this.isPublished,b.u.required],user:null===(h=null===(p=this.sessionQuery)||void 0===p?void 0:p.user)||void 0===h?void 0:h.name,uid:"",created_at:null===(m=this.config.formData)||void 0===m?void 0:m.created_at}),this.validationMessages={category:{required:"field is required."}},this.genericValidator=new k.a(this.validationMessages)}get fields(){return this.form.controls.additional_fields.get("fields")}ngOnInit(){this.auth.user.subscribe(t=>{this.uid=t.uid}),this.form.valueChanges.subscribe(()=>this.displayMessage=this.genericValidator.processMessages(this.form))}blur(){this.displayMessage=this.genericValidator.processMessages(this.form)}keyDown(t,o){return t.key?this.fun.allowedKey(t.key,o):(t.target.value=this.fun.removeNotAllowedKey(t.target.value,o),!0)}change(t){var o;const e=null===(o=this.selectedCategory.filter(o=>o.name===t)[0])||void 0===o?void 0:o.fields;if(e){this.fields.removeAt(0),this.fieldControls=[];const t=new b.g({});e.forEach(o=>{var e;const i=[];"email"===o.type&&i.push(b.u.email),o.required&&i.push(b.u.required);const n=i.length>0?[...i]:null;this.fieldControls.push(o),t.addControl(o.name,this.fb.control((null===(e=this.config)||void 0===e?void 0:e.formData[o.name])||o.default,n))}),this.fields.push(t)}}getFile(t){this.file=(null==t?void 0:t.upload.length)>0?null==t?void 0:t.upload:[]}onSubmit(){const t=this.fieldControls.filter(t=>"file"===t.type);t.length>0&&this.file.length>0&&(this.form.value.additional_fields.fields[0][t[0].name]=this.file);const o=Object(C.__rest)(this.form.value,[]),e=Object.assign({},o.additional_fields.fields[0]),i=Object(C.__rest)(e,[]);delete o.additional_fields;const n=Object.assign(Object.assign(Object.assign({},i),o),{uid:this.uid,status:this.isPublished});this.formSubmit.emit(n)}onCancel(){this.formClose.emit()}}return t.\u0275fac=function(o){return new(o||t)(w.Qb(b.e),w.Qb(V.a),w.Qb(O.a),w.Qb(W.a),w.Qb(u.a))},t.\u0275cmp=w.Kb({type:t,selectors:[["app-product-form"]],outputs:{formSubmit:"formSubmit",formClose:"formClose"},decls:36,vars:12,consts:[["autocomplete","off",3,"formGroup","submit"],["mat-dialog-title","",1,"p-dialog-header","p-d-flex","p-jc-lg-between",2,"padding","0.2re 0.3rem"],[1,"p-dialog-title","capitalize"],["pButton","","pRipple","","icon","pi pi-times",1,"shadow-none","p-button-rounded","p-button-plain","p-button-text","p-mr-1",3,"click"],["mat-dialog-content","",1,"p-dialog-content"],[1,"p-grid"],[1,"p-col-12"],[1,"full-width"],["formControlName","category",3,"closed","valueChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","error",4,"ngIf"],["formGroupName","additional_fields",1,"p-col-12"],["formArrayName","fields"],[3,"formGroupName",4,"ngFor","ngForOf"],["color","primary","forControlName","status",1,"example-section",3,"ngModel","ngModelOptions","ngModelChange"],["mat-dialog-actions","",1,"p-dialog-footer","button-row"],["pbutton","","pripple","","label","Cancel","type","button","icon","pi pi-times",1,"p-button-text","p-ripple","p-button","p-component","shadow-none","p-mr-2",3,"click"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-times"],[1,"p-button-label"],[1,"p-ink"],["pbutton","","pripple","","label","Save","icon","pi pi-check","type","submit",1,"p-button-text","p-ripple","p-button","p-component","shadow-none",3,"disabled"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-check"],[3,"value"],[1,"error"],[3,"formGroupName"],["class","full-width",4,"ngIf"],[1,"capitalize"],["matInput","","type","text","value","",3,"formControlName","input","keydown",4,"ngIf"],["matInput","","type","text","rows","2","value","",3,"formControlName","input","keydown",4,"ngIf"],[3,"formControlName",4,"ngIf"],["matInput","","type","text","value","",3,"formControlName","input","keydown"],["matInput","","type","text","rows","2","value","",3,"formControlName","input","keydown"],[3,"formControlName"],[3,"uploadedFile","fileDropped"]],template:function(t,o){1&t&&(w.Wb(0,"form",0),w.ec("submit",function(){return o.onSubmit()}),w.Wb(1,"div",1),w.Wb(2,"div",2),w.Qc(3),w.Vb(),w.Wb(4,"button",3),w.ec("click",function(){return o.onCancel()}),w.Vb(),w.Vb(),w.Wb(5,"div",4),w.Wb(6,"div",5),w.Wb(7,"div",6),w.Wb(8,"mat-form-field",7),w.Wb(9,"mat-label"),w.Qc(10,"Category"),w.Vb(),w.Wb(11,"mat-select",8),w.ec("closed",function(){return o.blur()})("valueChange",function(t){return o.change(t)}),w.Oc(12,x,2,2,"mat-option",9),w.ic(13,"async"),w.Vb(),w.Oc(14,N,2,0,"mat-hint",10),w.Oc(15,Q,2,1,"mat-error",11),w.Vb(),w.Vb(),w.Wb(16,"div",12),w.Wb(17,"div",13),w.Oc(18,U,3,3,"div",14),w.Vb(),w.Vb(),w.Wb(19,"mat-slide-toggle",15),w.ec("ngModelChange",function(t){return o.isPublished=t}),w.Wb(20,"span"),w.Qc(21,"Status"),w.Vb(),w.Rb(22,"br"),w.Wb(23,"mat-hint"),w.Qc(24,"block or allow product from displaying"),w.Vb(),w.Vb(),w.Vb(),w.Vb(),w.Wb(25,"div",16),w.Wb(26,"button",17),w.ec("click",function(){return o.onCancel()}),w.Rb(27,"span",18),w.Wb(28,"span",19),w.Qc(29,"Cancel"),w.Vb(),w.Rb(30,"span",20),w.Vb(),w.Wb(31,"button",21),w.Rb(32,"span",22),w.Wb(33,"span",19),w.Qc(34,"Save"),w.Vb(),w.Rb(35,"span",20),w.Vb(),w.Vb(),w.Vb()),2&t&&(w.oc("formGroup",o.form),w.Cb(3),w.Rc(o.config.title),w.Cb(9),w.oc("ngForOf",w.jc(13,9,o.category)),w.Cb(2),w.oc("ngIf",null===o.id),w.Cb(1),w.oc("ngIf",o.displayMessage.name),w.Cb(3),w.oc("ngForOf",o.fieldControls),w.Cb(1),w.oc("ngModel",o.isPublished)("ngModelOptions",w.rc(11,$)),w.Cb(12),w.oc("disabled",!o.form.valid))},directives:[b.v,b.q,b.h,u.g,p.b,f.a,u.e,D.c,D.g,l.a,b.p,b.f,y.l,y.m,b.i,b.d,r.a,b.s,D.f,u.c,I.h,D.b,s.b,b.c,S.a],pipes:[y.b],styles:[".example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}"]}),t})();var T=e("12jx"),H=e("sSZD"),J=e("wD+u");let z=(()=>{class t{constructor(t,o,e){this.db=t,this.firestore=o,this.fun=e,this.url="/Product"}get(t=null){const o=null!==t&&""!==t.split("=")[1]?`?${t}`:null!==t&&""===t.split("=")[1]&&Object(v.o)(t)?`/${t}`:"",e=`${this.url}`;return t?this.firestore.collection(e).doc(o):this.firestore.collection(e)}add(t,o=null){var e;delete t.id;const i=[],n=`${this.url}`;return(null===(e=null==t?void 0:t.image)||void 0===e?void 0:e.length)>0?t.image.forEach((e,c)=>this.fun.storeToFirebase(e,this.url).then(e=>{if(i.push(e),c+1===t.image.length)return t.image=i,t.created_at=(new Date).toISOString(),this.firestore.collection(n).add(t).then(t=>{this.fun.notify("Added"),o.ref.close(),o.block.stop()}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)});c++}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)})):(t.created_at=(new Date).toISOString(),this.firestore.collection(n).add(t).then(t=>{this.fun.notify("Added"),o.ref.close(),o.block.stop()}).catch(t=>{o.block.stop(),this.fun.notify("","Something error occur",3e3)}))}update(t,o,e=null){var i;delete o.id;let n=0;const c=[];return(null===(i=null==o?void 0:o.image)||void 0===i?void 0:i.length)>0?o.image.forEach((i,r)=>null==(null==i?void 0:i.url)?this.fun.storeToFirebase(i,this.url).then(i=>{if(c.push(i),n++,r+1===o.image.length)return o.image=c,this.firestore.collection(this.url).doc(t).update(o).then(t=>{this.fun.notify("Updated"),e.ref.close(),e.block.stop()}).catch(t=>{e.block.stop(),this.fun.notify("","Something error occur",3e3)});r++}).catch(t=>{e.block.stop(),this.fun.notify("","Something error occur",3e3)}):(c.push(null==i?void 0:i.url),0===n?(o.image=c,this.firestore.collection(this.url).doc(t).update(o).then(t=>{this.fun.notify("Update"),e.ref.close(),e.block.stop()}).catch(t=>{e.block.stop(),this.fun.notify("","Something error occur",3e3)})):void 0)):this.firestore.collection(this.url).doc(t).update(o).then(t=>{this.fun.notify("Update"),e.ref.close(),e.block.stop()}).catch(t=>{e.block.stop(),this.fun.notify("","Something error occur",3e3)})}delete(t){return this.firestore.collection(this.url).doc(t).delete()}}return t.\u0275fac=function(o){return new(o||t)(w.ac(H.a),w.ac(J.a),w.ac(W.a))},t.\u0275prov=w.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var L=e("GaOe"),Z=e("H0VJ"),Y=e("WLRH");let tt=(()=>{class t{constructor(t,o,e){this.productService=t,this.categoryService=o,this.dialogServices=e,this.caption="Products",this.columns=[{label:"Name",name:"name",sortable:!0},{label:"Image",name:"image",type:"image",sortable:!1},{label:"Category",name:"category",sortable:!0},{label:"Created By",name:"user",sortable:!0},{label:"Status",name:"status",type:"status",sortable:!0}],this.actions=[{icon:"pencil",color:"warning",disable:!1},{icon:"trash",color:"danger"}],this.toolBarActions=[{position:"right",action:[]},{position:"left",action:[{label:"Create",icon:"plus",color:"",tooltip:null}]}],this.dialogConfig={width:"540px",formComponent:K,service:this.productService}}ngOnInit(){let t;this.product$=t=this.productService.get().snapshotChanges(),this.category=this.categoryService.get().valueChanges()}add(){this.dialogConfig.title="New product",this.dialogConfig.formData="",this.dialogConfig.lookupData={category:this.category},this.dialogServices.handleDialog(this.dialogConfig)}update(t){this.dialogConfig.title="Edit product",this.dialogConfig.formData=t,this.dialogConfig.lookupData={category:this.category},this.dialogServices.handleDialog(this.dialogConfig)}onActionClick(t){"pencil"===t.type?this.update(t.data):"trash"===t.type&&(this.blockUI.start("Deleting..."),this.productService.delete(t.data.id).then(this.blockUI.stop()))}onToolBarActionClick(t){"plus"===t&&this.add()}}return t.\u0275fac=function(o){return new(o||t)(w.Qb(z),w.Qb(L.a),w.Qb(Z.a))},t.\u0275cmp=w.Kb({type:t,selectors:[["app-product"]],decls:2,vars:10,consts:[[3,"caption","columns","data","actions","first","rows","sortBy","toolBarActions","buttonClick","toolBarButtonClick"]],template:function(t,o){1&t&&(w.Wb(0,"app-table-template",0),w.ec("buttonClick",function(t){return o.onActionClick(t)})("toolBarButtonClick",function(t){return o.onToolBarActionClick(t)}),w.ic(1,"async"),w.Vb()),2&t&&w.oc("caption",o.caption)("columns",o.columns)("data",w.jc(1,8,o.product$))("actions",o.actions)("first",(null==o.currentPage?null:o.currentPage.first)||0)("rows",(null==o.currentPage?null:o.currentPage.rows)||10)("sortBy",o.sortBy)("toolBarActions",o.toolBarActions)},directives:[Y.a],pipes:[y.b],styles:[""]}),Object(C.__decorate)([Object(T.a)()],t.prototype,"blockUI",void 0),t})();var ot=e("tyNb");const et=[{path:"",component:tt},{path:"**",redirectTo:""}];let it=(()=>{class t{}return t.\u0275mod=w.Ob({type:t}),t.\u0275inj=w.Nb({factory:function(o){return new(o||t)},imports:[[ot.e.forChild(et)],ot.e]}),t})(),nt=(()=>{class t{}return t.\u0275mod=w.Ob({type:t}),t.\u0275inj=w.Nb({factory:function(o){return new(o||t)},imports:[[y.c,it,g.a,m.f,b.j,b.t,h.b,p.c,f.b,d.a,u.f,D.e,s.c,a.a,l.b,r.b,c.a,n.a,i.a]]}),t})()}}]);